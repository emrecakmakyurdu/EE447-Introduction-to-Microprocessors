PF_INP				EQU		0X40025040

;LABEL			DIRECTIVE	VALUE				COMMENT	
				AREA main,	CODE,	READONLY,	ALIGN=2
				THUMB
					
				IMPORT		InitSysTick
				IMPORT		PORTF_Init
				IMPORT 		DELAY100
				EXTERN		OutStr
				EXPORT		__main
;I AM GOING TO USE R5 TO CONTROL LED BLINK
;R6 TO CONTROL SWITCH
WLCM     	DCB     	"WELCOME"
			DCB			0x0D		; Carriage return is like new line
			DCB			0x04		; it is like EOF or \0	

MSG     	DCB     	">=100"
			DCB			0x0D		; Carriage return is like new line
			DCB			0x04		; it is like EOF or \0	

			
__main			PROC
				LDR			R5,=WLCM		;hosgeldin
				BL			OutStr
				BL			InitSysTick
				BL			PORTF_Init
				MOV			R6,#0			;IF r6 = 0, do not blink, r6 = 1 blink
				MOV			R5,#0			;IF R5 = 1, THE KEY IS PRESSED ONCE (COUNT), IF R5 = 0 THE KEY IS PRESSED TWICE OR NOT PRESSED YET (DO NOT COUNT)
				MOV			R7,#0			;CHECK IF 100 SECONDS IS EXCEEDED OR NOT

				MOV			R8,#0			;R8'I HANGI SANIYEDE OLDUGUMUZU BULMAK ICIN KULLANIYORUM
				
				
LOOP			CMP			R7,#100			;100 SANIYE OLDUYSA
				BLEQ		PRINT100
				LDR			R0,=PF_INP			;PORTF_DATA REGISTERININ ADRESINI R0'YA KAYDEDIYORUM
				LDRB		R1,[R0]					;PORTF_DATA REGISTERINDEKI DEGERI R1'E KAYDEDIYORUM
				BL			DELAY100						;100MSEC BEKLIYORUM
				LDRB		R2,[R0]					;PORTF_DATA REGISTERINDEKI DEGERI R2'YE KAYDEDIYORUM
				CMP			R1,R2							;DEBOUNCING ICIN KARSILASTIRMA YAPIYORUM
				BNE			LOOP							;DEGILSE YANLISLIK OLMUS, TEKRAR INPUT ALIYORUM
				CMP			R1,#0X10						;R1 VE R2 AYNI OLMASINA RAGMEN 0X10 ISELER, HICBIR TUSA BASILMAMIS DEMEKTIR, TEKRAR INPUT ALIYORUM
				BEQ			LOOP		
				CPY			R4,R1
RELEASE			LDRB		R1,[R0]					;PORTF_DATA'DA SAKLANAN DEGERI R1'E YUKLUYORUM
				BL			DELAY100
				LDRB		R2,[R0]					;PORTF_DATA'DA SAKLANAN DEGERI R2'YE YUKLUYORUM
				CMP			R1,R2							;DEBOUNCING
				BNE			RELEASE
				CMP			R1,#0X00						;EGER HALA TUSA BASILI ISE BIRAKANA KADAR BEKLIYORUM, RELEASE'YE DONUYORUM
				BNE			RELEASE							;EGER TUS BIRAKILDIYSA, R1'E 0XF0 YUKLENIYOR VE BU LOOP'TAN CIKILIYOR
				CMP			R4,#0
				ADDEQ		R5,#1					;TUSA BASILDIGI ICIN ARTTIR
				B			LOOP
				
PRINT100		PUSH		{LR}
				LDR			R5,=MSG			;100 oldugunu gosteren mesaji vas
				BL			OutStr
				LDR			R5,=WLCM		;resetledigin icin welcome de
				BL			OutStr	
				MOV			R8,#0			;SIFIRLAMALARI YAP
				MOV			R7,#0
				MOV			R6,#0				
				MOV			R5,#0
				POP			{LR}
				BX			LR
	
	
				ENDP
					
					
					
					
				END